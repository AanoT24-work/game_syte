{% extends 'main/main.html' %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è{% endblock %}

{% block style %}
    <link rel="stylesheet" href="{{url_for('static', filename='css/blocks/body/all.css')}}">
{% endblock %}

{% block content %}

<div class="main-container">
    <div class="publick-header">
        <h3>–ü—É–±–ª–∏–∫–∞—Ü–∏–∏</h3>
    </div>

    <div class="publick-grid" id="posts-container">
        {% for post in posts.items %}
            <div class="publick-item" data-post-id="{{ post.id }}">
                <div class="publick-info">
                    <div class="publick-avatar">
                        {% if post.user.avatar and post.user.avatar != 'default_avatar.png' %}
                            <img src="{{ url_for('user.get_avatar', user_id=post.user.id) }}" alt="–ê–≤–∞—Ç–∞—Ä">
                        {% else %}
                            <span>üë§</span>
                        {% endif %}
                    </div>
                    <a href="{{ url_for('user.profile', user_id=post.user.id) }}" class="publick-author">Username: {{ post.user.login }}</a>
                </div>
                
                {% if post.image %}
                    <div class="publick-image-container">
                        <img src="{{ url_for('post.get_post_image', post_id=post.id) }}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å—Ç–∞" class="publick-image" loading="lazy">
                    </div>
                {% endif %}
                
                <p class="publick-content">{{ post.content }}</p>
                
                <div class="publick-meta">
                    <small class="publick-date">{{ post.created_at.strftime('%d.%m.%Y %H:%M') }}</small>
                    
                    <div class="like-comm-container">
                        <!-- –ö–Ω–æ–ø–∫–∞ –ª–∞–π–∫–∞ —Å —Å—á–µ—Ç—á–∏–∫–æ–º -->
                       <div class="like-wrapper">
                            <button class="like-btn {% if current_user.is_authenticated and current_user.id in (post.liked_by or []) %}liked{% endif %}" 
                                data-post-id="{{ post.id }}"
                                {% if not current_user.is_authenticated %}disabled title="–í–æ–π–¥–∏—Ç–µ —á—Ç–æ–±—ã –ª–∞–π–∫–∞—Ç—å"{% endif %}>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 18" class="icon favorite">
                                    <path d="M14.44 0C12.63 0 11.01 0.88 10 2.23C9.48413 1.53881 8.81426 0.977391 8.04353 0.590295C7.27281 0.203198 6.42247 0.00108555 5.56 0C2.49 0 0 2.5 0 5.59C0 6.78 0.19 7.88 0.52 8.9C2.1 13.9 6.97 16.89 9.38 17.71C9.72 17.83 10.28 17.83 10.62 17.71C13.03 16.89 17.9 13.9 19.48 8.9C19.81 7.88 20 6.78 20 5.59C20 2.5 17.51 0 14.44 0Z"></path>
                                </svg>
                                <span class="like-count" id="like-count-{{ post.id }}">{{ (post.liked_by or [])|length }}</span>
                            </button>
                        </div>

                        <!-- –ö–Ω–æ–ø–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
                        <a href="{{ url_for('post.post_detail', post_id=post.id) }}" class="link">
                            <span class="link-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" viewBox="0 0 256 256">
                                    <path d="M45.42853,176.99811A95.95978,95.95978,0,1,1,79.00228,210.5717l.00023-.001L45.84594,220.044a8,8,0,0,1-9.89-9.89l9.47331-33.15657Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></path>
                                    <line x1="96" y1="112" x2="160" y2="112" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
                                    <line x1="96" y1="144" x2="160" y2="144" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
                                </svg>
                            </span>
                        </a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loading-indicator" style="display: none; text-align: center; padding: 20px;">
        <div class="spinner">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–≥–¥–∞ –ø–æ—Å—Ç—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å -->
    <div id="no-more-posts" style="display: none; text-align: center; padding: 20px;">
        <p>–ë–æ–ª—å—à–µ –ø–æ—Å—Ç–æ–≤ –Ω–µ—Ç</p>
    </div>
        <!-- –§–æ–Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã -->
    <div class="background-elements">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
        <div class="particles"></div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/body/infinite-scroll-fixed.js') }}"></script>

{% endblock %}